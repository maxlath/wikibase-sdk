!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.wdk=e()}}(function(){return function e(t,r,n){function i(s,u){if(!r[s]){if(!t[s]){var a="function"==typeof require&&require;if(!u&&a)return a(s,!0);if(o)return o(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var c=r[s]={exports:{}};t[s][0].call(c.exports,function(e){var r=t[s][1][e];return i(r||e)},c,c.exports,e,t,r,n)}return r[s].exports}for(var o="function"==typeof require&&require,s=0;s<n.length;s++)i(n[s]);return i}({1:[function(e,t,r){"use strict";var n=e("./wikidata_time_to_date_object"),i={};i.isNumericId=function(e){return/^[0-9]+$/.test(e)},i.isEntityId=function(e){return/^(Q|P)[0-9]+$/.test(e)},i.isItemId=function(e){return/^Q[0-9]+$/.test(e)},i.isPropertyId=function(e){return/^P[0-9]+$/.test(e)},i.getNumericId=function(e){if(!i.isEntityId(e))throw new Error("invalid wikidata id: "+e);return e.replace(/Q|P/,"")},i.wikidataTimeToDateObject=n;var o=function(e){return function(t){try{return e(t)}catch(e){return t}}},s=function(e){return n(e).getTime()},u=function(e){return n(e).toISOString()};i.wikidataTimeToEpochTime=o(s),i.wikidataTimeToISOString=o(u),t.exports=i},{"./wikidata_time_to_date_object":8}],2:[function(e,t,r){"use strict";var n=e("./helpers"),i=n.wikidataTimeToISOString,o=n.wikidataTimeToEpochTime,s=function(e){return e.value},u=function(e,t){return t.keepRichValues?e.value:e.value.text},a=function(e,t){return f(e,t.entityPrefix)},l=function(e,t){return f(e,t.propertyPrefix)},c={item:"Q",property:"P"},f=function(e,t){var r=e.value,n=r.id||c[r["entity-type"]]+r["numeric-id"];return"string"==typeof t?t+":"+n:n},p=function(e,t){var r=e.value,n=parseFloat(r.amount);if(t.keepRichValues){return{amount:parseFloat(r.amount),unit:r.unit.replace("http://www.wikidata.org/entity/",""),upperBound:parseFloat(r.upperBound),lowerBound:parseFloat(r.lowerBound)}}return n},y=function(e){return[e.value.latitude,e.value.longitude]},d=function(e,t){return m(t.timeConverter)(e.value.time)},m=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"iso";return h[e]},v=function(e){return e},h={iso:i,epoch:o,none:v},g={string:s,commonsMedia:s,url:s,"external-id":s,math:s,monolingualtext:u,"wikibase-item":a,"wikibase-property":l,time:d,quantity:p,"globe-coordinate":y,"geo-shape":s,"tabular-data":s};t.exports=function(e,t,r){return g[e](t,r)}},{"./helpers":1}],3:[function(e,t,r){"use strict";var n=e("./simplify_entity");t.exports={wd:{entities:function(e){e=e.body||e;var t=e,r=t.entities;return Object.keys(r).forEach(function(e){r[e]=n(r[e])}),r}}}},{"./simplify_entity":5}],4:[function(e,t,r){"use strict";var n=function(){function e(e,t){var r=[],n=!0,i=!1,o=void 0;try{for(var s,u=e[Symbol.iterator]();!(n=(s=u.next()).done)&&(r.push(s.value),!t||r.length!==t);n=!0);}catch(e){i=!0,o=e}finally{try{!n&&u.return&&u.return()}finally{if(i)throw o}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=e("./parse_claim"),s=e("../utils/utils"),u=s.uniq,a=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var i=d(r),o=i.propertyPrefix,s={};for(var u in e){var a=e[u];o&&(u=o+":"+u),s[u]=l.apply(void 0,[a].concat(r))}return s},l=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var o=d(r),s=o.keepNonTruthy,a=o.areSubSnaks;return s||a||(e=f(e)),e=e.map(function(e){return y.apply(void 0,[e].concat(r))}).filter(p),e[0]&&"object"!==i(e[0])?u(e):e},c=function(e,t){var r=t.rank;return e[r]||(e[r]=[]),e[r].push(t),e},f=function(e){var t=e.reduce(c,{});return t.preferred||t.normal||[]},p=function(e){return null!=e},y=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];r=d(r);var i,s,u,l,c=r,f=c.keepQualifiers,p=c.keepReferences,y=c.keepIds,m=c.keepHashes,v=e.mainsnak;if(v){if(i=v.datatype,!(s=v.datavalue))return null}else{if(!e||!e.datavalue)return null;s=e.datavalue,i=e.datatype,e.hash?u=!0:l=!0}var h=o(i,s,r);if(u)return m?{value:h,hash:e.hash}:h;if(l)return h;if(!(f||p||y))return h;var g={value:h},b=Object.assign({},r,{areSubSnaks:!0,keepHashes:m});return f&&(g.qualifiers=a(e.qualifiers,b)),p&&(e.references=e.references||[],g.references=e.references.map(function(e){var t=a(e.snaks,b);return m?{snaks:t,hash:e.hash}:t})),y&&(g.id=e.id),g},d=function(e){if(null==e)return{};if(e[0]&&"object"===i(e[0]))return e[0];var t=n(e,3);return{entityPrefix:t[0],propertyPrefix:t[1],keepQualifiers:t[2]}};t.exports={simplifyClaims:a,simplifyPropertyClaims:l,simplifyClaim:y}},{"../utils/utils":19,"./parse_claim":2}],5:[function(e,t,r){"use strict";var n=e("./simplify_claims"),i=n.simplifyClaims,o=e("./simplify_text_attributes");t.exports=function(e,t){return{id:e.id,type:e.type,modified:e.modified,labels:o.labels(e.labels),descriptions:o.descriptions(e.descriptions),aliases:o.aliases(e.aliases),claims:i(e.claims,t),sitelinks:o.sitelinks(e.sitelinks)}}},{"./simplify_claims":4,"./simplify_text_attributes":7}],6:[function(e,t,r){"use strict";var n=function(){function e(e,t){var r=[],n=!0,i=!1,o=void 0;try{for(var s,u=e[Symbol.iterator]();!(n=(s=u.next()).done)&&(r.push(s.value),!t||r.length!==t);n=!0);}catch(e){i=!0,o=e}finally{try{!n&&u.return&&u.return()}finally{if(i)throw o}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.exports=function(e){"string"==typeof e&&(e=JSON.parse(e));var t=e.head.vars,r=e.results.bindings;if(1===t.length){var o=t[0];return r.map(function(e){return i(e[o])}).filter(function(e){return null!=e})}var s=f(t),u=n(s,2),a=u[0],l=u[1];return r.map(p(a,l))};var i=function(e){if(e){var t=e.datatype;t=t&&t.replace("http://www.w3.org/2001/XMLSchema#","");return(o[e.type]||u(t))(e)}},o={uri:function(e){return c(e.value)},bnode:function(){return null}},s=function(e){return parseFloat(e.value)},u=function(e){return e=e&&e.replace("http://www.w3.org/2001/XMLSchema#",""),a[e]||l},a={decimal:s,integer:s,float:s,double:s,boolean:function(e){return"true"===e.value}},l=function(e){return e.value},c=function(e){return e.replace("http://www.wikidata.org/entity/","").replace("http://www.wikidata.org/prop/direct/","")},f=function(e){var t=[],r=[],n=!0,i=!1,o=void 0;try{for(var s,u=e[Symbol.iterator]();!(n=(s=u.next()).done);n=!0){var a=s.value;e.indexOf(a+"Label")>-1?t.push(a):/^\w+Label$/.test(a)||r.push(a)}}catch(e){i=!0,o=e}finally{try{!n&&u.return&&u.return()}finally{if(i)throw o}}return[t,r]},p=function(e,t){return function(r){var n={},o=!0,s=!1,u=void 0;try{for(var a,l=e[Symbol.iterator]();!(o=(a=l.next()).done);o=!0){var c=a.value,f=i(r[c]);if(null!=f){var p=r[c+"Label"]&&r[c+"Label"].value;n[c]={value:f,label:p}}}}catch(e){s=!0,u=e}finally{try{!o&&l.return&&l.return()}finally{if(s)throw u}}var y=!0,d=!1,m=void 0;try{for(var v,h=t[Symbol.iterator]();!(y=(v=h.next()).done);y=!0){var g=v.value;n[g]=i(r[g])}}catch(e){d=!0,m=e}finally{try{!y&&h.return&&h.return()}finally{if(d)throw m}}return n}}},{}],7:[function(e,t,r){"use strict";var n=function(e,t){return function(r){var n={};return Object.keys(r).forEach(function(o){var s=r[o];n[o]=e?s.map(i):s[t]}),n}},i=function(e){return e.value},o=n(!1,"value");t.exports={labels:o,descriptions:o,aliases:n(!0,"value"),sitelinks:n(!1,"title")}},{}],8:[function(e,t,r){"use strict";t.exports=function(e){var t=e[0],r=e.slice(1),i=n(t,r);return"Invalid Date"===i.toString()?s(t,r):i};var n=function(e,t){return"-"===e?o(t):i(t)},i=function(e){return new Date(e)},o=function(e){var t="-00"+e;return new Date(t)},s=function(e,t){var r=t.split("T")[0].split("-")[0];return n(e,r)}},{}],9:[function(e,t,r){"use strict";var n=t.exports={};n.searchEntities=e("./queries/search_entities"),n.getEntities=e("./queries/get_entities"),n.getManyEntities=e("./queries/get_many_entities"),n.getWikidataIdsFromSitelinks=e("./queries/get_wikidata_ids_from_sitelinks"),n.sparqlQuery=e("./queries/sparql_query"),n.getReverseClaims=e("./queries/get_reverse_claims"),n.getRevisions=e("./queries/get_revisions"),n.parse=e("./helpers/parse_responses");var i=e("./helpers/simplify_claims"),o=e("./helpers/simplify_sparql_results");n.simplify=e("../lib/helpers/simplify_text_attributes"),n.simplify.entity=e("../lib/helpers/simplify_entity"),n.simplify.claim=i.simplifyClaim,n.simplify.propertyClaims=i.simplifyPropertyClaims,n.simplify.claims=i.simplifyClaims,n.simplify.sparqlResults=o,n.simplifySparqlResults=e("./helpers/simplify_sparql_results"),Object.assign(n,i),n.getWikidataIdsFromWikipediaTitles=n.getWikidataIdsFromSitelinks,Object.assign(n,e("./helpers/helpers"))},{"../lib/helpers/simplify_entity":5,"../lib/helpers/simplify_text_attributes":7,"./helpers/helpers":1,"./helpers/parse_responses":3,"./helpers/simplify_claims":4,"./helpers/simplify_sparql_results":6,"./queries/get_entities":10,"./queries/get_many_entities":11,"./queries/get_reverse_claims":12,"./queries/get_revisions":13,"./queries/get_wikidata_ids_from_sitelinks":14,"./queries/search_entities":15,"./queries/sparql_query":16}],10:[function(e,t,r){"use strict";var n=e("../utils/build_url"),i=e("../utils/utils"),o=i.isPlainObject,s=i.forceArray,u=i.shortLang;t.exports=function(e,t,r,i){if(o(e)){var a=e;e=a.ids,t=a.languages,r=a.props,i=a.format}if(i=i||"json",!(e&&e.length>0))throw new Error("no id provided");e=s(e),e.length>50&&console.warn("getEntities accepts 50 ids max to match Wikidata API limitations:\n      this request won't get all the desired entities.\n      You can use getManyEntities instead to generate several request urls\n      to work around this limitation");var l={action:"wbgetentities",ids:e.join("|"),format:i};return t&&(t=s(t).map(u),l.languages=t.join("|")),r&&r.length>0&&(l.props=s(r).join("|")),n(l)}},{"../utils/build_url":17,"../utils/utils":19}],11:[function(e,t,r){"use strict";var n=e("./get_entities"),i=e("../utils/utils"),o=i.isPlainObject;t.exports=function(e,t,r,i){if(o(e)){var u=e;e=u.ids,t=u.languages,r=u.props,i=u.format}if(!(e instanceof Array))throw new Error("getManyEntities expects an array of ids");return s(e).map(function(e){return n(e,t,r,i)})};var s=function(e){for(var t=[];e.length>0;){var r=e.slice(0,50);e=e.slice(50),t.push(r)}return t}},{"../utils/utils":19,"./get_entities":10}],12:[function(e,t,r){"use strict";function n(e){return s.isItemId(e)?e="wd:"+e:"string"==typeof e&&(e="'"+e+"'"),e}function i(e,t,r,n){return"SELECT ?subject WHERE {\n      ?subject wdt:"+e+" "+t+" .\n      "+r+"\n    }\n    LIMIT "+n}function o(e,t,r,n){return"SELECT ?subject WHERE {\n    ?subject wdt:"+e+" ?value .\n    FILTER (lcase(?value) = "+t.toLowerCase()+")\n    "+r+"\n  }\n  LIMIT "+n}var s=e("../helpers/helpers"),u=e("./sparql_query");t.exports=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=r.limit,a=r.caseInsensitive,l=r.keepProperties;s=s||1e3;var c=a?o:i,f=n(t),p=l?"":"FILTER NOT EXISTS { ?subject rdf:type wikibase:Property . } ",y=c(e,f,p,s);return u(y)}},{"../helpers/helpers":1,"./sparql_query":16}],13:[function(e,t,r){"use strict";var n=e("../utils/build_url"),i=e("../utils/utils"),o=i.forceArray;t.exports=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e=o(e);var r=1===e.length,i={action:"query",prop:"revisions"};return i.titles=e.join("|"),i.format=t.format||"json",r&&(i.rvlimit=t.limit||"max"),r&&t.start&&(i.rvstart=s(t.start)),r&&t.end&&(i.rvend=s(t.end)),n(i)};var s=function(e){return"number"==typeof e&&e<u?e:Math.trunc(new Date(e).getTime()/1e3)},u=new Date("2000-01-01").getTime()},{"../utils/build_url":17,"../utils/utils":19}],14:[function(e,t,r){"use strict";var n=e("../utils/build_url"),i=e("../utils/utils"),o=i.isPlainObject,s=i.forceArray,u=i.shortLang;t.exports=function(e,t,r,i,l){if(o(e)){var c=e;e=c.titles,t=c.sites,r=c.languages,i=c.props,l=c.format}if(l=l||"json",!(e&&e.length>0))throw new Error("no title provided");t&&t.length>0||(t=["enwiki"]),e=s(e),t=s(t).map(a),i=s(i);var f={action:"wbgetentities",titles:e.join("|"),sites:t.join("|"),format:l};return 1===t.length&&1===e.length&&(f.normalize=!0),r&&(r=s(r).map(u),f.languages=r.join("|")),i&&i.length>0&&(f.props=i.join("|")),n(f)};var a=function(e){return 2===e.length?e+"wiki":e}},{"../utils/build_url":17,"../utils/utils":19}],15:[function(e,t,r){"use strict";var n=e("../utils/build_url"),i=e("../utils/utils"),o=i.isPlainObject;t.exports=function(e,t,r,i,s){if(o(e)){var u=e;e=u.search,t=u.language,r=u.limit,i=u.format,s=u.uselang}if(!(e&&e.length>0))throw new Error("search can't be empty");return t=t||"en",s=s||t,r=r||"20",i=i||"json",n({action:"wbsearchentities",search:e,language:t,limit:r,format:i,uselang:s})}},{"../utils/build_url":17,"../utils/utils":19}],16:[function(e,t,r){"use strict";var n=e("../utils/utils"),i=n.fixedEncodeURIComponent;t.exports=function(e){return"https://query.wikidata.org/sparql?format=json&query="+i(e)}},{"../utils/utils":19}],17:[function(e,t,r){"use strict";var n="undefined"!=typeof location&&"undefined"!=typeof document,i=e(n?"./querystring_lite":"querystring");t.exports=function(e){return n&&(e.origin="*"),"https://www.wikidata.org/w/api.php?"+i.stringify(e)}},{"./querystring_lite":18,querystring:22}],18:[function(e,t,r){"use strict";t.exports={stringify:function(e){var t="";for(var r in e){var n=e[r];n&&(t+="&"+r+"="+n)}return t=t.slice(1),encodeURI?encodeURI(t):t}}},{}],19:[function(e,t,r){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.exports={shortLang:function(e){return e.toLowerCase().split(/[^a-z]/)[0]},forceArray:function(e){return"string"==typeof e&&(e=[e]),e||[]},isPlainObject:function(e){return!(!e||"object"!==(void 0===e?"undefined":n(e))||e instanceof Array)},fixedEncodeURIComponent:function(e){return encodeURIComponent(e).replace(/[!'()*]/g,i)},uniq:function(e){return Array.from(new Set(e))}};var i=function(e){return"%"+e.charCodeAt(0).toString(16)}},{}],20:[function(e,t,r){"use strict";function n(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.exports=function(e,t,r,o){t=t||"&",r=r||"=";var s={};if("string"!=typeof e||0===e.length)return s;e=e.split(t);var u=1e3;o&&"number"==typeof o.maxKeys&&(u=o.maxKeys);var a=e.length;u>0&&a>u&&(a=u);for(var l=0;l<a;++l){var c,f,p,y,d=e[l].replace(/\+/g,"%20"),m=d.indexOf(r);m>=0?(c=d.substr(0,m),f=d.substr(m+1)):(c=d,f=""),p=decodeURIComponent(c),y=decodeURIComponent(f),n(s,p)?i(s[p])?s[p].push(y):s[p]=[s[p],y]:s[p]=y}return s};var i=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},{}],21:[function(e,t,r){"use strict";function n(e,t){if(e.map)return e.map(t);for(var r=[],n=0;n<e.length;n++)r.push(t(e[n],n));return r}var i=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};t.exports=function(e,t,r,u){return t=t||"&",r=r||"=",null===e&&(e=void 0),"object"==typeof e?n(s(e),function(s){var u=encodeURIComponent(i(s))+r;return o(e[s])?n(e[s],function(e){return u+encodeURIComponent(i(e))}).join(t):u+encodeURIComponent(i(e[s]))}).join(t):u?encodeURIComponent(i(u))+r+encodeURIComponent(i(e)):""};var o=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},s=Object.keys||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push(r);return t}},{}],22:[function(e,t,r){"use strict";r.decode=r.parse=e("./decode"),r.encode=r.stringify=e("./encode")},{"./decode":20,"./encode":21}]},{},[9])(9)});
