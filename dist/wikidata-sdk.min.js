!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.wdk=e()}}(function(){return function e(t,r,n){function i(a,u){if(!r[a]){if(!t[a]){var s="function"==typeof require&&require;if(!u&&s)return s(a,!0);if(o)return o(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var c=r[a]={exports:{}};t[a][0].call(c.exports,function(e){var r=t[a][1][e];return i(r?r:e)},c,c.exports,e,t,r,n)}return r[a].exports}for(var o="function"==typeof require&&require,a=0;a<n.length;a++)i(n[a]);return i}({1:[function(e,t,r){"use strict";var n=e("./wikidata_time_to_date_object"),i={};i.isNumericId=function(e){return/^[0-9]+$/.test(e)},i.isWikidataId=function(e){return/^(Q|P)[0-9]+$/.test(e)},i.isWikidataEntityId=function(e){return/^Q[0-9]+$/.test(e)},i.isWikidataPropertyId=function(e){return/^P[0-9]+$/.test(e)},i.normalizeId=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Q";if(i.isNumericId(e))return t?e:""+r+e;if(i.isWikidataId(e))return t?e.slice(1):e;throw new Error("invalid id")},i.getNumericId=function(e){if(!i.isWikidataId(e))throw new Error("invalid wikidata id: "+e);return e.replace(/Q|P/,"")},i.normalizeIds=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Q";return e.map(function(e){return i.normalizeId(e,t,r)})},i.wikidataTimeToDateObject=n,i.wikidataTimeToEpochTime=function(e){return n(e).getTime()},i.wikidataTimeToISOString=function(e){return n(e).toISOString()},i.normalizeWikidataTime=i.wikidataTimeToEpochTime,t.exports=i},{"./wikidata_time_to_date_object":4}],2:[function(e,t,r){"use strict";var n=e("./simplify_claims");t.exports={wd:{entities:function e(t){t=t.body||t;var r=t,e=r.entities;for(var i in e){var o=e[i];o.claims=n(o.claims)}return e}}}},{"./simplify_claims":3}],3:[function(e,t,r){"use strict";var n=e("./helpers"),i=function(e,t,r,n){var i={};for(var a in e){var u=e[a];r&&(a=r+":"+a),i[a]=o(u,t,r,n)}return i},o=function(e,t,r,n){return e.map(function(e){return u(e,t,r,n)}).filter(a)},a=function(e){return null!=e},u=function(e,t,r,o){var a=e.mainsnak,u=e.qualifiers;if(null==a)return null;var f=a.datatype,p=a.datavalue;if(null==p)return null;var d=null;switch(f){case"string":case"commonsMedia":case"url":case"external-id":d=p.value;break;case"monolingualtext":d=p.value.text;break;case"wikibase-item":d=s(p,t);break;case"wikibase-property":d=s(p,r);break;case"time":d=n.normalizeWikidataTime(p.value.time);break;case"quantity":d=parseFloat(p.value.amount);break;case"globe-coordinate":d=l(p.value)}if(o){var y={};for(var m in u)y[m]=u[m].map(c);return{value:d,qualifiers:i(y,t,r)}}return d},s=function(e,t){var r=e.value.id;return"string"==typeof t?t+":"+r:r},l=function(e){return[e.latitude,e.longitude]},c=function(e){return{mainsnak:e}};t.exports={simplifyClaims:i,simplifyPropertyClaims:o,simplifyClaim:u}},{"./helpers":1}],4:[function(e,t,r){"use strict";t.exports=function(e){var t=e[0],r=e.slice(1),i=n(t,r);return"Invalid Date"===i.toString()?a(t,r):i};var n=function(e,t){return"-"===e?o(t):i(t)},i=function(e){return new Date(e)},o=function(e){var t="-00"+e;return new Date(t)},a=function(e,t){var r=t.split("T")[0].split("-")[0];return n(e,r)}},{}],5:[function(e,t,r){"use strict";var n=t.exports={};n.searchEntities=e("./queries/search_entities"),n.getEntities=e("./queries/get_entities"),n.getManyEntities=e("./queries/get_many_entities"),n.getWikidataIdsFromSitelinks=e("./queries/get_wikidata_ids_from_sitelinks"),n.sparqlQuery=e("./queries/sparql_query"),n.getReverseClaims=e("./queries/get_reverse_claims"),n.parse=e("./helpers/parse_responses");var i=e("./helpers/simplify_claims"),o=i.simplifyClaim,a=i.simplifyPropertyClaims,u=i.simplifyClaims;n.simplifyClaim=o,n.simplifyPropertyClaims=a,n.simplifyClaims=u,n.simplifySparqlResults=e("./queries/simplify_sparql_results"),n.getWikidataIdsFromWikipediaTitles=n.getWikidataIdsFromSitelinks;var s=e("./helpers/helpers");n.helpers=s;for(var l in s)n[l]=s[l]},{"./helpers/helpers":1,"./helpers/parse_responses":2,"./helpers/simplify_claims":3,"./queries/get_entities":6,"./queries/get_many_entities":7,"./queries/get_reverse_claims":8,"./queries/get_wikidata_ids_from_sitelinks":9,"./queries/search_entities":10,"./queries/simplify_sparql_results":11,"./queries/sparql_query":12}],6:[function(e,t,r){"use strict";var n=e("../helpers/helpers"),i=e("../utils/build_url"),o=e("../utils/utils"),a=o.isPlainObject,u=o.forceArray,s=o.shortLang;t.exports=function(e,t,r,o){if(a(e)){var l=e;e=l.ids,t=l.languages,r=l.props,o=l.format}if(o=o||"json",!(e&&e.length>0))throw new Error("no id provided");e.length>50&&console.warn("getEntities accepts 50 ids max to match Wikidata API limitations:\n      this request won't get all the desired entities.\n      You can use getManyEntities instead to generate several request urls\n      to work around this limitation"),e=n.normalizeIds(u(e)),r=u(r);var c={action:"wbgetentities",ids:e.join("|"),format:o};return t&&(t=u(t).map(s),c.languages=t.join("|")),r&&r.length>0&&(c.props=r.join("|")),i(c)}},{"../helpers/helpers":1,"../utils/build_url":13,"../utils/utils":15}],7:[function(e,t,r){"use strict";function n(e,t){return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var i=n(["getManyEntities expects an array of ids"],["getManyEntities expects an array of ids"]),o=e("./get_entities"),a=e("../utils/utils"),u=a.isPlainObject;t.exports=function(e,t,r,n){if(u(e)){var a=e;e=a.ids,t=a.languages,r=a.props,n=a.format}if(!(e instanceof Array))throw new(Error(i));return s(e).map(function(e){return o(e,t,r,n)})};var s=function(e){for(var t=[];e.length>0;){var r=e.slice(0,50);e=e.slice(50),t.push(r)}return t}},{"../utils/utils":15,"./get_entities":6}],8:[function(e,t,r){"use strict";var n=e("../helpers/helpers"),i=e("./sparql_query");t.exports=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;n.isWikidataEntityId(t)?t="wd:"+t:"string"==typeof t&&(t="`"+t+"`");var o="\n    SELECT ?subject WHERE {\n      ?subject wdt:"+e+" "+t+" .\n    }\n    LIMIT "+r+"\n    ";return i(o)}},{"../helpers/helpers":1,"./sparql_query":12}],9:[function(e,t,r){"use strict";var n=e("../utils/build_url"),i=e("../utils/utils"),o=i.isPlainObject,a=i.forceArray,u=i.shortLang;t.exports=function(e,t,r,i,l){if(o(e)){var c=e;e=c.titles,t=c.sites,r=c.languages,i=c.props,l=c.format}if(l=l||"json",!(e&&e.length>0))throw new Error("no title provided");t&&t.length>0||(t=["enwiki"]),e=a(e),t=a(t).map(s),i=a(i);var f={action:"wbgetentities",titles:e.join("|"),sites:t.join("|"),format:l};return r&&(r=a(r).map(u),f.languages=r.join("|")),i&&i.length>0&&(f.props=i.join("|")),n(f)};var s=function(e){return 2===e.length?e+"wiki":e}},{"../utils/build_url":13,"../utils/utils":15}],10:[function(e,t,r){"use strict";var n=e("../utils/build_url"),i=e("../utils/utils"),o=i.isPlainObject;t.exports=function(e,t,r,i,a){if(o(e)){var u=e;e=u.search,t=u.language,r=u.limit,i=u.format,a=u.uselang}if(!(e&&e.length>0))throw new Error("search can't be empty");return t=t||"en",a=a||t,r=r||"20",i=i||"json",n({action:"wbsearchentities",search:e,language:t,limit:r,format:i,uselang:a})}},{"../utils/build_url":13,"../utils/utils":15}],11:[function(e,t,r){"use strict";var n=function(){function e(e,t){var r=[],n=!0,i=!1,o=void 0;try{for(var a,u=e[Symbol.iterator]();!(n=(a=u.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){i=!0,o=e}finally{try{!n&&u.return&&u.return()}finally{if(i)throw o}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.exports=function(e){"string"==typeof e&&(e=JSON.parse(e));var t=e.head.vars,r=e.results.bindings;if(1!==t.length){var a=p(t),u=n(a,2),s=u[0],l=u[1];return r.map(d(s,l))}var c=function(){var e=t[0];return{v:r.map(function(t){return o(t[e])}).filter(function(e){return null!=e})}}();if("object"===("undefined"==typeof c?"undefined":i(c)))return c.v};var o=function(e){if(e){var t=e.datatype;t=t&&t.replace("http://www.w3.org/2001/XMLSchema#","");var r=a[e.type]||s(t);return r(e)}},a={uri:function(e){return f(e.value)},bnode:function(){return null}},u=function(e){return parseFloat(e.value)},s=function(e){return e=e&&e.replace("http://www.w3.org/2001/XMLSchema#",""),l[e]||c},l={decimal:u,integer:u,float:u,double:u,boolean:function(e){return"true"===e.value}},c=function(e){return e.value},f=function(e){return e.replace("http://www.wikidata.org/entity/","")},p=function(e){var t=[],r=[],n=!0,i=!1,o=void 0;try{for(var a,u=e[Symbol.iterator]();!(n=(a=u.next()).done);n=!0){var s=a.value;e.indexOf(s+"Label")>-1?t.push(s):/^\w+Label$/.test(s)||r.push(s)}}catch(e){i=!0,o=e}finally{try{!n&&u.return&&u.return()}finally{if(i)throw o}}return[t,r]},d=function(e,t){return function(r){var n={},i=!0,a=!1,u=void 0;try{for(var s,l=e[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var c=s.value;n[c]={value:o(r[c]),label:r[c+"Label"].value}}}catch(e){a=!0,u=e}finally{try{!i&&l.return&&l.return()}finally{if(a)throw u}}var f=!0,p=!1,d=void 0;try{for(var y,m=t[Symbol.iterator]();!(f=(y=m.next()).done);f=!0){var v=y.value;n[v]=o(r[v])}}catch(e){p=!0,d=e}finally{try{!f&&m.return&&m.return()}finally{if(p)throw d}}return n}}},{}],12:[function(e,t,r){"use strict";t.exports=function(e){var t=encodeURIComponent(e);return"https://query.wikidata.org/sparql?format=json&query="+t}},{}],13:[function(e,t,r){"use strict";var n="https://www.wikidata.org/w/api.php",i="undefined"!=typeof location&&"undefined"!=typeof document,o=e(i?"./querystring_lite":"querystring");t.exports=function(e){return i&&(e.origin="*"),n+"?"+o.stringify(e)}},{"./querystring_lite":14,querystring:18}],14:[function(e,t,r){"use strict";t.exports={stringify:function(e){var t="";for(var r in e){var n=e[r];n&&(t+="&"+r+"="+n)}return t=t.slice(1),encodeURI?encodeURI(t):t}}},{}],15:[function(e,t,r){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.exports={shortLang:function(e){return e.slice(0,2)},forceArray:function(e){return"string"==typeof e&&(e=[e]),e||[]},isPlainObject:function(e){return!(!e||"object"!==("undefined"==typeof e?"undefined":n(e))||e instanceof Array)}}},{}],16:[function(e,t,r){"use strict";function n(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.exports=function(e,t,r,o){t=t||"&",r=r||"=";var a={};if("string"!=typeof e||0===e.length)return a;var u=/\+/g;e=e.split(t);var s=1e3;o&&"number"==typeof o.maxKeys&&(s=o.maxKeys);var l=e.length;s>0&&l>s&&(l=s);for(var c=0;c<l;++c){var f,p,d,y,m=e[c].replace(u,"%20"),v=m.indexOf(r);v>=0?(f=m.substr(0,v),p=m.substr(v+1)):(f=m,p=""),d=decodeURIComponent(f),y=decodeURIComponent(p),n(a,d)?i(a[d])?a[d].push(y):a[d]=[a[d],y]:a[d]=y}return a};var i=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},{}],17:[function(e,t,r){"use strict";function n(e,t){if(e.map)return e.map(t);for(var r=[],n=0;n<e.length;n++)r.push(t(e[n],n));return r}var i=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};t.exports=function(e,t,r,u){return t=t||"&",r=r||"=",null===e&&(e=void 0),"object"==typeof e?n(a(e),function(a){var u=encodeURIComponent(i(a))+r;return o(e[a])?n(e[a],function(e){return u+encodeURIComponent(i(e))}).join(t):u+encodeURIComponent(i(e[a]))}).join(t):u?encodeURIComponent(i(u))+r+encodeURIComponent(i(e)):""};var o=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},a=Object.keys||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push(r);return t}},{}],18:[function(e,t,r){"use strict";r.decode=r.parse=e("./decode"),r.encode=r.stringify=e("./encode")},{"./decode":16,"./encode":17}]},{},[5])(5)});
